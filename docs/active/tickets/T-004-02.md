---
id: T-004-02
story: S-004
title: audio-sfx-and-music
type: task
status: open
priority: high
phase: done
depends_on: [T-001-01]
---

## Context

Define all sound effects and compose chiptune music tracks using Pyxel's native 4-channel audio engine. Reference MP3s in assets/ guide the musical feel but compositions are original chiptune arrangements.

Reference: docs/specification.md section 6

## Acceptance Criteria

- [ ] `audio.py` implements:
  - `init_audio()`: defines all sounds[] and musics[] entries at startup
  - `play_sfx(sfx_id)`: plays a sound effect on channel 3
  - `play_music(track_id)`: starts a music track looping on channels 0–2
  - `stop_music()`: stops all music channels
- [ ] **Sound effects** (sounds[] slots 0–15): all 16 SFX from the spec defined as Pyxel sound data or MML strings. Each should be recognizable for its purpose (ring collect is a bright arpeggio, spindash charge is a rising buzz, etc.)
- [ ] **Music tracks** (musics[] slots 0–6):
  - Track 0: title/menu theme — transcribed from Genesis_of_Glory.mp3 feel
  - Track 1: Hillside Rush — transcribed from Pixel_Pursuit.mp3 feel
  - Track 2: Pipe Works — transcribed from Chrome_Citadel.mp3 feel
  - Track 3: Skybridge Gauntlet — transcribed from Genesis_Gauntlet.mp3 feel
  - Track 4: boss theme — original, tense and rhythmic
  - Track 5: stage clear jingle — short ascending fanfare
  - Track 6: game over — short somber phrase
- [ ] Each music track uses 3 channels (melody, bass, percussion) via musics[] entry
- [ ] SFX priority: channel 3 SFX preempts immediately, channel 2 (percussion) ducks during SFX
- [ ] All tracks loop cleanly (no audible gap at loop point)
- [ ] Standalone test: running audio.py plays each track/SFX for verification
