---
id: T-005-02
story: S-005
title: hillside-loop-collision-fix
type: bug
status: open
priority: high
phase: done
depends_on: []
---

## Context

The full 360° loop in Hillside Rush Section 5 (around x=3200–4000) is broken. The loop circle `<circle cx="3600" cy="380" r="128"/>` has its center too high — the bottom of the circle is at y=508, but the normal ground level in the loop zone is y=636. This creates a 128px gap between the loop bottom and the ground, making the loop unreachable during normal gameplay.

## Changes

In `stages/hillside_rush.svg`, Section 5 (lines ~219–244):

1. **Fix loop circle center**: Change `cy="380"` to `cy="508"` so the loop bottom sits at y=636 (ground level). The loop will span y=380 (top) to y=636 (bottom).
2. **Remove ground-beneath-loop polygon** (lines 241–244): The polygon `3472,508 3728,508 3728,720 3472,720` was filling the gap caused by the wrong circle center. With the circle corrected, it's no longer needed.
3. **Simplify approach polygon**: The approach polygon currently slopes from y=636 down to y=508. Since the loop bottom is now at y=636, flatten the approach to stay at ground level y=636. Change to a simple flat polygon connecting to the loop entry point at x=3472, y=636.
4. **Simplify exit polygon**: Similarly, flatten the exit polygon so it starts at y=636 (loop bottom) and stays at ground level.
5. **Regenerate stage data**: Run `uv run python tools/svg2stage.py stages/hillside_rush.svg speednik/stages/hillside/` to produce updated tile_map.json, collision.json, entities.json, meta.json.
6. **Verify**: Check validation_report.txt for zero errors/critical flags.

## Acceptance Criteria

- [ ] Loop circle has `cy="508"` and `r="128"`, placing bottom at y=636 (ground level)
- [ ] No "ground beneath the loop" filler polygon exists
- [ ] Approach polygon is flat at y=636, connecting smoothly to loop entry
- [ ] Exit polygon is flat at y=636, connecting smoothly from loop exit
- [ ] `uv run python tools/svg2stage.py stages/hillside_rush.svg speednik/stages/hillside/` runs successfully
- [ ] `speednik/stages/hillside/validation_report.txt` has no errors
- [ ] Loop ring positions (ring_131–ring_150) still form a circular pattern inside the loop (may need center adjustment to match new cy)
