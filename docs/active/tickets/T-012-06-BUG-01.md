---
id: T-012-06-BUG-01
story: S-012
title: synthetic-loop-no-ceiling-quadrant
type: bug
status: open
priority: high
phase: done
depends_on: []
---

## Summary

Synthetic loops built with `build_loop()` cannot be fully traversed at spindash speed.
The player never reaches quadrant 2 (ceiling angles 97-160). Instead, the player enters
the loop ramp (quadrant 1), then goes airborne over the loop rather than following
the curved surface through the ceiling.

## Reproduction

```python
from speednik.grids import build_loop
from speednik.simulation import create_sim_from_lookup, sim_step
from speednik.terrain import get_quadrant

_, lookup = build_loop(approach_tiles=15, radius=48, ground_row=20, ramp_radius=24)
sim = create_sim_from_lookup(lookup, 48.0, 300.0)
# Spindash then hold right for 600 frames
# -> quadrants_visited == {0, 1, 3}, missing quadrant 2
```

Tested radii: 32, 48, 64, 96. All fail identically â€” no quadrant 2 reached.

## Analysis

The player hits the loop entry ramp angles (quadrant 1, byte angles 33-96) but the
physics engine doesn't attach the player to the curved surface. At spindash speed (8.0),
the player launches airborne instead of transitioning to ceiling mode (quadrant 2).

For radii 32 and 48, the player lands past the loop on exit tiles (quadrants {0, 1, 3}).
For radii 64 and 96, the player overshoots the exit entirely (see T-012-06-BUG-02).

Possible causes:
- `build_loop` geometry doesn't produce smooth enough angle transitions for the
  collision system to track the surface continuously
- Physics engine lacks loop-specific ground attachment logic (centripetal lock)
- SURFACE_LOOP tile_type not correctly forcing surface adhesion at high angles

## Impact

Every stage using loops inherits this limitation. The hillside loop works via different
geometry (hand-placed tiles with smoother transitions), but the generic `build_loop`
builder produces loops that are not mechanically functional for full traversal.
